#!/usr/bin/perl

# äöüÄÖÜß
# Extracts relations from the output of TreeSolver for elliptic equations and prepar SVG generation
# @(#) $Id$
# Copyright (c) 2017 Dr. Georg Fischer
# 2017-08-08: copied from fermcay7.pl

use strict;
my $node  = -2;
my $var2  = 0;
my %omap  = (); # maps identical mod expansion tuple lines to their occurrences
my %kmap  = (); # maps identical mod expansion tuple lines to their keys
my $ikey  = 1;
my $key   = "k1";
my $father = 0;

my $line  = <>;
# Expanding for base=3, level=5, reasons+features=base,similiar invall,norm
$line =~ m{base\=(\d+)\,\s*level\=(\d+)};
my $base  = $1;
my $level = $2;
my @tuples = ();
my $width  = "1600";
my $height = $width;
print <<"GFis";
<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.0//EN"
 "http://www.w3.org/TR/2001/REC-SVG-20010904/DTD/svg10.dtd" [
 <!ATTLIST svg xmlns:xlink CDATA #FIXED "http://www.w3.org/1999/xlink">
]>
<!--
    2017-08-08, Dr. Georg Fischer: show TreeSolver trees
-->
<svg width="${width}px" height="${height}px"
    viewBox="0 0 ${width} ${height}"
    xmlns="http://www.w3.org/2000/svg"
    xmlns:xlink="http://www.w3.org/1999/xlink"
    >
    <defs>
        <style type="text/css"><![CDATA[
            .k1 { fill: orange          }
            .k2 { fill: lime            }
            .k3 { fill: cornflowerblue  }
            .k4 { fill: crimson         }
            .k5 { fill: forestgreen     }
            .k6 { fill: darkblue        }
            .k7 { fill: yellow          }
            .k8 { fill: darkmagenta     }
            rect {
                stroke: white;
                stroke-width:0.1
            }
        ]]></style>
    </defs>
<title>TreeSolver</title>
<g style="font-size:10">
GFis
print "<!--base=$base, level=$level-->\n";
my $x  = 0;
my $dx = 20;
my $h  = $dx - 2; # height of one rect
my $y  = 0;
my $dy = 20;
my $w  = 0; # width of one rect
my $count = $base > 2 ? 2 : 1; # number of nodes in one level / SVG row
my $inode = 0; # number of current node in SVG row
my @mirror = ();
my $nomirror = 0;

while (<>) { # read output of TreeSolver, c.f. <DATA> below
    $line = $_;
    $line =~ s/\s+\Z//; # chompr
    $line =~ s/\A\s+//; # leading spaces
    if (0) {
    } elsif ($line =~ m{\A\-\-+\s*level\s+(\d)}) { # new level
    	if ($count >= 2) { # check symmetry
    		my $ic = 0;
    		while ($count - $ic - 1 > $ic) {
    			if ($mirror[$count - $ic - 1] ne $mirror[$ic]) {
    				print "<!-- not mirrored: level=$level, ic=$ic -->\n";
    				$nomirror ++;
    			}
    			$ic ++;
    		} # while checking
    	} # count > 2
    	@mirror = ();
        $level = $1;
        $y += $dy;
        $inode = 0;
        if ($level > 1) {
            $count *= $base;
        }
    } elsif ($line =~ m{\Aexpanding queue\[(\d+)\]\^(\-?\d+)}) {
        $node = $1;
        $inode ++;
        $father = $2;
        @tuples = ();
    } elsif ($line =~ m{\A\[[^\:]+\:\s*unknown\s*\-\>\s*\[\d+\]\s+\[(\d+\,\d+)\]}) { # [1+8x,3+8y]: unknown -> [3] [1,0] 2x+8x²-27y-72y²-64y³-3
        push(@tuples, $1);
    } elsif (($line =~ m{\Aendexp}) and ($level >= 1)) {
        my $char = join(" ", @tuples);
        if (defined($omap{$char})) {
            $omap{$char} ++;
            $key = $kmap{$char};
        } else {
            $omap{$char} = 1;
            $key = "k$ikey";
            $ikey ++;
            $kmap{$char} = $key;
        }
        push(@mirror, $key);
        if (0) {
        } elsif ($level < 1) {
            # ignore
        } elsif (scalar(@tuples) == $base) {
            print "<!-- " . join(" ", $level, $node, $father, $key, $x, $count, $inode) . " --> ";
            my $split  = ($width - 4 * $dx) / $count;
            my $spl2   = ($split / 2);
            my $spl4   = ($split / 4);
            $w    = int($spl2);
            my $x = $dx + int($inode * $split - $spl2 - $spl4);
            print <<"GFis";
    <rect class="$key" y="$y" x="$x" width="$w" height="$h" />
GFis
            if ($w >= 4) {
                my $tx = $dx + int($inode * $split - $spl2 - $spl4 + 2);
                my $ty = $y + $dy / 2;
                print <<"GFis";
                <text x="$tx" y="$ty">$node</text>
GFis
            }
        } else {
            print STDERR "invalid size: " . join("\t", $level, $node, $father, $char) . "\n";
        }
        # endexp
    } else {
    }
} # while <>
foreach my $okey (sort(keys(%omap))) {
    print sprintf("<!--%-8s %4d %s-->\n", $kmap{$okey}, $omap{$okey}, $okey);
} # foreach
print <<"GFis";
<!-- not mirrored: $nomirror -->
</g>
</svg>
GFis

__DATA__
Expanding for base=3, level=5, reasons+features=base,similiar invall,norm
Refined variables=x,y
[0+1x,0+1y]:    unknown -> [1] [0,0] x²-y³+2
---------------- level 0
expanding queue[0]^-1,meter=[3,3]: x²-y³+2
[1+3x,0+3y]:    unknown -> [1] [1,0] 2x+3x²-9y³+1
[2+3x,0+3y]:    unknown -> [2] [2,0] 4x+3x²-9y³+2
-> solution [5,3],NONTRIVIAL
endexp[0]
---------------- level 1
expanding queue[1]^0,meter=[3,3]: 2x+3x²-9y³+1
[4+9x,0+9y]:    unknown -> [3] [1,0] 8x+9x²-81y³+2
[4+9x,3+9y]:    unknown -> [4] [1,1] 8x+9x²-27y-81y²-81y³-1
[4+9x,6+9y]:    unknown -> [5] [1,2] 8x+9x²-108y-162y²-81y³-22
endexp[1]
expanding queue[2]^0,meter=[3,3]: 4x+3x²-9y³+2
[5+9x,0+9y]:    unknown -> [6] [1,0] 10x+9x²-81y³+3
[5+9x,3+9y]:    unknown -> [7] [1,1] 10x+9x²-27y-81y²-81y³
-> solution [5,3],NONTRIVIAL
[5+9x,6+9y]:    unknown -> [8] [1,2] 10x+9x²-108y-162y²-81y³-21
endexp[2]
---------------- level 2
expanding queue[3]^1,meter=[3,3]: 8x+9x²-81y³+2
[22+27x,0+27y]: unknown -> [9] [2,0] 44x+27x²-729y³+18
[22+27x,9+27y]: unknown -> [10] [2,1] 44x+27x²-243y-729y²-729y³-9
[22+27x,18+27y]:    unknown -> [11] [2,2] 44x+27x²-972y-1458y²-729y³-198
endexp[3]
expanding queue[4]^1,meter=[3,3]: 8x+9x²-27y-81y²-81y³-1
[22+27x,3+27y]: unknown -> [12] [2,0] 44x+27x²-27y-243y²-729y³+17
[22+27x,12+27y]:    unknown -> [13] [2,1] 44x+27x²-432y-972y²-729y³-46
[22+27x,21+27y]:    unknown -> [14] [2,2] 44x+27x²-1323y-1701y²-729y³-325
endexp[4]
expanding queue[5]^1,meter=[3,3]: 8x+9x²-108y-162y²-81y³-22
[22+27x,6+27y]: unknown -> [15] [2,0] 44x+27x²-108y-486y²-729y³+10
[22+27x,15+27y]:    unknown -> [16] [2,1] 44x+27x²-675y-1215y²-729y³-107
[22+27x,24+27y]:    unknown -> [17] [2,2] 44x+27x²-1728y-1944y²-729y³-494
endexp[5]
expanding queue[6]^2,meter=[3,3]: 10x+9x²-81y³+3
[5+27x,0+27y]:  unknown -> [18] [0,0] 10x+27x²-729y³+1
[5+27x,9+27y]:  unknown -> [19] [0,1] 10x+27x²-243y-729y²-729y³-26
[5+27x,18+27y]: unknown -> [20] [0,2] 10x+27x²-972y-1458y²-729y³-215
endexp[6]
expanding queue[7]^2,meter=[3,3]: 10x+9x²-27y-81y²-81y³
[5+27x,3+27y]:  unknown -> [21] [0,0] 10x+27x²-27y-243y²-729y³
-> solution [5,3],NONTRIVIAL
[5+27x,12+27y]: unknown -> [22] [0,1] 10x+27x²-432y-972y²-729y³-63
[5+27x,21+27y]: unknown -> [23] [0,2] 10x+27x²-1323y-1701y²-729y³-342
endexp[7]
expanding queue[8]^2,meter=[3,3]: 10x+9x²-108y-162y²-81y³-21
[5+27x,6+27y]:  unknown -> [24] [0,0] 10x+27x²-108y-486y²-729y³-7
[5+27x,15+27y]: unknown -> [25] [0,1] 10x+27x²-675y-1215y²-729y³-124
[5+27x,24+27y]: unknown -> [26] [0,2] 10x+27x²-1728y-1944y²-729y³-511
endexp[8]
---------------- level 3
expanding queue[9]^3,meter=[3,3]: 44x+27x²-729y³+18
[22+81x,0+81y]: unknown -> [27] [0,0] 44x+81x²-6561y³+6
[22+81x,27+81y]:    unknown -> [28] [0,1] 44x+81x²-2187y-6561y²-6561y³-237
[22+81x,54+81y]:    unknown -> [29] [0,2] 44x+81x²-8748y-13122y²-6561y³-1938
endexp[9]
expanding queue[10]^3,meter=[3,3]: 44x+27x²-243y-729y²-729y³-9
[22+81x,9+81y]: unknown -> [30] [0,0] 44x+81x²-243y-2187y²-6561y³-3
[22+81x,36+81y]:    unknown -> [31] [0,1] 44x+81x²-3888y-8748y²-6561y³-570
[22+81x,63+81y]:    unknown -> [32] [0,2] 44x+81x²-11907y-15309y²-6561y³-3081
endexp[10]
expanding queue[11]^3,meter=[3,3]: 44x+27x²-972y-1458y²-729y³-198
[22+81x,18+81y]:    unknown -> [33] [0,0] 44x+81x²-972y-4374y²-6561y³-66
[22+81x,45+81y]:    unknown -> [34] [0,1] 44x+81x²-6075y-10935y²-6561y³-1119
[22+81x,72+81y]:    unknown -> [35] [0,2] 44x+81x²-15552y-17496y²-6561y³-4602
endexp[11]
expanding queue[12]^4,meter=[3,3]: 44x+27x²-27y-243y²-729y³+17
[76+81x,3+81y]: unknown -> [36] [2,0] 152x+81x²-27y-729y²-6561y³+71
[76+81x,30+81y]:    unknown -> [37] [2,1] 152x+81x²-2700y-7290y²-6561y³-262
[76+81x,57+81y]:    unknown -> [38] [2,2] 152x+81x²-9747y-13851y²-6561y³-2215
endexp[12]
expanding queue[13]^4,meter=[3,3]: 44x+27x²-432y-972y²-729y³-46
[76+81x,12+81y]:    unknown -> [39] [2,0] 152x+81x²-432y-2916y²-6561y³+50
[76+81x,39+81y]:    unknown -> [40] [2,1] 152x+81x²-4563y-9477y²-6561y³-661
[76+81x,66+81y]:    unknown -> [41] [2,2] 152x+81x²-13068y-16038y²-6561y³-3478
endexp[13]
expanding queue[14]^4,meter=[3,3]: 44x+27x²-1323y-1701y²-729y³-325
[76+81x,21+81y]:    unknown -> [42] [2,0] 152x+81x²-1323y-5103y²-6561y³-43
[76+81x,48+81y]:    unknown -> [43] [2,1] 152x+81x²-6912y-11664y²-6561y³-1294
[76+81x,75+81y]:    unknown -> [44] [2,2] 152x+81x²-16875y-18225y²-6561y³-5137
endexp[14]
expanding queue[15]^5,meter=[3,3]: 44x+27x²-108y-486y²-729y³+10
[49+81x,6+81y]: unknown -> [45] [1,0] 98x+81x²-108y-1458y²-6561y³+27
[49+81x,33+81y]:    unknown -> [46] [1,1] 98x+81x²-3267y-8019y²-6561y³-414
[49+81x,60+81y]:    unknown -> [47] [1,2] 98x+81x²-10800y-14580y²-6561y³-2637
endexp[15]
expanding queue[16]^5,meter=[3,3]: 44x+27x²-675y-1215y²-729y³-107
[49+81x,15+81y]:    unknown -> [48] [1,0] 98x+81x²-675y-3645y²-6561y³-12
[49+81x,42+81y]:    unknown -> [49] [1,1] 98x+81x²-5292y-10206y²-6561y³-885
[49+81x,69+81y]:    unknown -> [50] [1,2] 98x+81x²-14283y-16767y²-6561y³-4026
endexp[16]
expanding queue[17]^5,meter=[3,3]: 44x+27x²-1728y-1944y²-729y³-494
[49+81x,24+81y]:    unknown -> [51] [1,0] 98x+81x²-1728y-5832y²-6561y³-141
[49+81x,51+81y]:    unknown -> [52] [1,1] 98x+81x²-7803y-12393y²-6561y³-1608
[49+81x,78+81y]:    unknown -> [53] [1,2] 98x+81x²-18252y-18954y²-6561y³-5829
endexp[17]
expanding queue[18]^6,meter=[3,3]: 10x+27x²-729y³+1
[59+81x,0+81y]: unknown -> [54] [2,0] 118x+81x²-6561y³+43
[59+81x,27+81y]:    unknown -> [55] [2,1] 118x+81x²-2187y-6561y²-6561y³-200
[59+81x,54+81y]:    unknown -> [56] [2,2] 118x+81x²-8748y-13122y²-6561y³-1901
endexp[18]
expanding queue[19]^6,meter=[3,3]: 10x+27x²-243y-729y²-729y³-26
[59+81x,9+81y]: unknown -> [57] [2,0] 118x+81x²-243y-2187y²-6561y³+34
[59+81x,36+81y]:    unknown -> [58] [2,1] 118x+81x²-3888y-8748y²-6561y³-533
[59+81x,63+81y]:    unknown -> [59] [2,2] 118x+81x²-11907y-15309y²-6561y³-3044
endexp[19]
expanding queue[20]^6,meter=[3,3]: 10x+27x²-972y-1458y²-729y³-215
[59+81x,18+81y]:    unknown -> [60] [2,0] 118x+81x²-972y-4374y²-6561y³-29
[59+81x,45+81y]:    unknown -> [61] [2,1] 118x+81x²-6075y-10935y²-6561y³-1082
[59+81x,72+81y]:    unknown -> [62] [2,2] 118x+81x²-15552y-17496y²-6561y³-4565
endexp[20]
expanding queue[21]^7,meter=[3,3]: 10x+27x²-27y-243y²-729y³
[5+81x,3+81y]:  unknown -> [63] [0,0] 10x+81x²-27y-729y²-6561y³
-> solution [5,3],NONTRIVIAL
[5+81x,30+81y]: unknown -> [64] [0,1] 10x+81x²-2700y-7290y²-6561y³-333
[5+81x,57+81y]: unknown -> [65] [0,2] 10x+81x²-9747y-13851y²-6561y³-2286
endexp[21]
expanding queue[22]^7,meter=[3,3]: 10x+27x²-432y-972y²-729y³-63
[5+81x,12+81y]: unknown -> [66] [0,0] 10x+81x²-432y-2916y²-6561y³-21
[5+81x,39+81y]: unknown -> [67] [0,1] 10x+81x²-4563y-9477y²-6561y³-732
[5+81x,66+81y]: unknown -> [68] [0,2] 10x+81x²-13068y-16038y²-6561y³-3549
endexp[22]
expanding queue[23]^7,meter=[3,3]: 10x+27x²-1323y-1701y²-729y³-342
[5+81x,21+81y]: unknown -> [69] [0,0] 10x+81x²-1323y-5103y²-6561y³-114
[5+81x,48+81y]: unknown -> [70] [0,1] 10x+81x²-6912y-11664y²-6561y³-1365
[5+81x,75+81y]: unknown -> [71] [0,2] 10x+81x²-16875y-18225y²-6561y³-5208
endexp[23]
expanding queue[24]^8,meter=[3,3]: 10x+27x²-108y-486y²-729y³-7
[32+81x,6+81y]: unknown -> [72] [1,0] 64x+81x²-108y-1458y²-6561y³+10
[32+81x,33+81y]:    unknown -> [73] [1,1] 64x+81x²-3267y-8019y²-6561y³-431
[32+81x,60+81y]:    unknown -> [74] [1,2] 64x+81x²-10800y-14580y²-6561y³-2654
endexp[24]
expanding queue[25]^8,meter=[3,3]: 10x+27x²-675y-1215y²-729y³-124
[32+81x,15+81y]:    unknown -> [75] [1,0] 64x+81x²-675y-3645y²-6561y³-29
[32+81x,42+81y]:    unknown -> [76] [1,1] 64x+81x²-5292y-10206y²-6561y³-902
[32+81x,69+81y]:    unknown -> [77] [1,2] 64x+81x²-14283y-16767y²-6561y³-4043
endexp[25]
expanding queue[26]^8,meter=[3,3]: 10x+27x²-1728y-1944y²-729y³-511
[32+81x,24+81y]:    unknown -> [78] [1,0] 64x+81x²-1728y-5832y²-6561y³-158
[32+81x,51+81y]:    unknown -> [79] [1,1] 64x+81x²-7803y-12393y²-6561y³-1625
[32+81x,78+81y]:    unknown -> [80] [1,2] 64x+81x²-18252y-18954y²-6561y³-5846
endexp[26]
---------------- level 4
expanding queue[27]^9,meter=[3,3]: 44x+81x²-6561y³+6
[22+243x,0+243y]:   unknown -> [81] [0,0] 44x+243x²-59049y³+2
[22+243x,81+243y]:  unknown -> [82] [0,1] 44x+243x²-19683y-59049y²-59049y³-2185
[22+243x,162+243y]: unknown -> [83] [0,2] 44x+243x²-78732y-118098y²-59049y³-17494
endexp[27]
expanding queue[28]^9,meter=[3,3]: 44x+81x²-2187y-6561y²-6561y³-237
[22+243x,27+243y]:  unknown -> [84] [0,0] 44x+243x²-2187y-19683y²-59049y³-79
[22+243x,108+243y]: unknown -> [85] [0,1] 44x+243x²-34992y-78732y²-59049y³-5182
[22+243x,189+243y]: unknown -> [86] [0,2] 44x+243x²-107163y-137781y²-59049y³-27781
endexp[28]
expanding queue[29]^9,meter=[3,3]: 44x+81x²-8748y-13122y²-6561y³-1938
[22+243x,54+243y]:  unknown -> [87] [0,0] 44x+243x²-8748y-39366y²-59049y³-646
[22+243x,135+243y]: unknown -> [88] [0,1] 44x+243x²-54675y-98415y²-59049y³-10123
[22+243x,216+243y]: unknown -> [89] [0,2] 44x+243x²-139968y-157464y²-59049y³-41470
endexp[29]
expanding queue[30]^10,meter=[3,3]: 44x+81x²-243y-2187y²-6561y³-3
[22+243x,9+243y]:   unknown -> [90] [0,0] 44x+243x²-243y-6561y²-59049y³-1
[22+243x,90+243y]:  unknown -> [91] [0,1] 44x+243x²-24300y-65610y²-59049y³-2998
[22+243x,171+243y]: unknown -> [92] [0,2] 44x+243x²-87723y-124659y²-59049y³-20575
endexp[30]
expanding queue[31]^10,meter=[3,3]: 44x+81x²-3888y-8748y²-6561y³-570
[22+243x,36+243y]:  unknown -> [93] [0,0] 44x+243x²-3888y-26244y²-59049y³-190
[22+243x,117+243y]: unknown -> [94] [0,1] 44x+243x²-41067y-85293y²-59049y³-6589
[22+243x,198+243y]: unknown -> [95] [0,2] 44x+243x²-117612y-144342y²-59049y³-31942
endexp[31]
expanding queue[32]^10,meter=[3,3]: 44x+81x²-11907y-15309y²-6561y³-3081
[22+243x,63+243y]:  unknown -> [96] [0,0] 44x+243x²-11907y-45927y²-59049y³-1027
[22+243x,144+243y]: unknown -> [97] [0,1] 44x+243x²-62208y-104976y²-59049y³-12286
[22+243x,225+243y]: unknown -> [98] [0,2] 44x+243x²-151875y-164025y²-59049y³-46873
endexp[32]
expanding queue[33]^11,meter=[3,3]: 44x+81x²-972y-4374y²-6561y³-66
[22+243x,18+243y]:  unknown -> [99] [0,0] 44x+243x²-972y-13122y²-59049y³-22
[22+243x,99+243y]:  unknown -> [100] [0,1] 44x+243x²-29403y-72171y²-59049y³-3991
[22+243x,180+243y]: unknown -> [101] [0,2] 44x+243x²-97200y-131220y²-59049y³-23998
endexp[33]
expanding queue[34]^11,meter=[3,3]: 44x+81x²-6075y-10935y²-6561y³-1119
[22+243x,45+243y]:  unknown -> [102] [0,0] 44x+243x²-6075y-32805y²-59049y³-373
[22+243x,126+243y]: unknown -> [103] [0,1] 44x+243x²-47628y-91854y²-59049y³-8230
[22+243x,207+243y]: unknown -> [104] [0,2] 44x+243x²-128547y-150903y²-59049y³-36499
endexp[34]
expanding queue[35]^11,meter=[3,3]: 44x+81x²-15552y-17496y²-6561y³-4602
[22+243x,72+243y]:  unknown -> [105] [0,0] 44x+243x²-15552y-52488y²-59049y³-1534
[22+243x,153+243y]: unknown -> [106] [0,1] 44x+243x²-70227y-111537y²-59049y³-14737
[22+243x,234+243y]: unknown -> [107] [0,2] 44x+243x²-164268y-170586y²-59049y³-52726
endexp[35]
expanding queue[36]^12,meter=[3,3]: 152x+81x²-27y-729y²-6561y³+71
[238+243x,3+243y]:  unknown -> [108] [2,0] 476x+243x²-27y-2187y²-59049y³+233
[238+243x,84+243y]: unknown -> [109] [2,1] 476x+243x²-21168y-61236y²-59049y³-2206
[238+243x,165+243y]:    unknown -> [110] [2,2] 476x+243x²-81675y-120285y²-59049y³-18253
endexp[36]
expanding queue[37]^12,meter=[3,3]: 152x+81x²-2700y-7290y²-6561y³-262
[238+243x,30+243y]: unknown -> [111] [2,0] 476x+243x²-2700y-21870y²-59049y³+122
[238+243x,111+243y]:    unknown -> [112] [2,1] 476x+243x²-36963y-80919y²-59049y³-5395
[238+243x,192+243y]:    unknown -> [113] [2,2] 476x+243x²-110592y-139968y²-59049y³-28894
endexp[37]
expanding queue[38]^12,meter=[3,3]: 152x+81x²-9747y-13851y²-6561y³-2215
[238+243x,57+243y]: unknown -> [114] [2,0] 476x+243x²-9747y-41553y²-59049y³-529
[238+243x,138+243y]:    unknown -> [115] [2,1] 476x+243x²-57132y-100602y²-59049y³-10582
[238+243x,219+243y]:    unknown -> [116] [2,2] 476x+243x²-143883y-159651y²-59049y³-42991
endexp[38]
expanding queue[39]^13,meter=[3,3]: 152x+81x²-432y-2916y²-6561y³+50
[238+243x,12+243y]: unknown -> [117] [2,0] 476x+243x²-432y-8748y²-59049y³+226
[238+243x,93+243y]: unknown -> [118] [2,1] 476x+243x²-25947y-67797y²-59049y³-3077
[238+243x,174+243y]:    unknown -> [119] [2,2] 476x+243x²-90828y-126846y²-59049y³-21446
endexp[39]
expanding queue[40]^13,meter=[3,3]: 152x+81x²-4563y-9477y²-6561y³-661
[238+243x,39+243y]: unknown -> [120] [2,0] 476x+243x²-4563y-28431y²-59049y³-11
[238+243x,120+243y]:    unknown -> [121] [2,1] 476x+243x²-43200y-87480y²-59049y³-6878
[238+243x,201+243y]:    unknown -> [122] [2,2] 476x+243x²-121203y-146529y²-59049y³-33185
endexp[40]
expanding queue[41]^13,meter=[3,3]: 152x+81x²-13068y-16038y²-6561y³-3478
[238+243x,66+243y]: unknown -> [123] [2,0] 476x+243x²-13068y-48114y²-59049y³-950
[238+243x,147+243y]:    unknown -> [124] [2,1] 476x+243x²-64827y-107163y²-59049y³-12839
[238+243x,228+243y]:    unknown -> [125] [2,2] 476x+243x²-155952y-166212y²-59049y³-48542
endexp[41]
expanding queue[42]^14,meter=[3,3]: 152x+81x²-1323y-5103y²-6561y³-43
[238+243x,21+243y]: unknown -> [126] [2,0] 476x+243x²-1323y-15309y²-59049y³+195
[238+243x,102+243y]:    unknown -> [127] [2,1] 476x+243x²-31212y-74358y²-59049y³-4134
[238+243x,183+243y]:    unknown -> [128] [2,2] 476x+243x²-100467y-133407y²-59049y³-24987
endexp[42]
expanding queue[43]^14,meter=[3,3]: 152x+81x²-6912y-11664y²-6561y³-1294
[238+243x,48+243y]: unknown -> [129] [2,0] 476x+243x²-6912y-34992y²-59049y³-222
[238+243x,129+243y]:    unknown -> [130] [2,1] 476x+243x²-49923y-94041y²-59049y³-8601
[238+243x,210+243y]:    unknown -> [131] [2,2] 476x+243x²-132300y-153090y²-59049y³-37878
endexp[43]
expanding queue[44]^14,meter=[3,3]: 152x+81x²-16875y-18225y²-6561y³-5137
[238+243x,75+243y]: unknown -> [132] [2,0] 476x+243x²-16875y-54675y²-59049y³-1503
[238+243x,156+243y]:    unknown -> [133] [2,1] 476x+243x²-73008y-113724y²-59049y³-15390
[238+243x,237+243y]:    unknown -> [134] [2,2] 476x+243x²-168507y-172773y²-59049y³-54549
endexp[44]
expanding queue[45]^15,meter=[3,3]: 98x+81x²-108y-1458y²-6561y³+27
[49+243x,6+243y]:   unknown -> [135] [0,0] 98x+243x²-108y-4374y²-59049y³+9
[49+243x,87+243y]:  unknown -> [136] [0,1] 98x+243x²-22707y-63423y²-59049y³-2700
[49+243x,168+243y]: unknown -> [137] [0,2] 98x+243x²-84672y-122472y²-59049y³-19503
endexp[45]
expanding queue[46]^15,meter=[3,3]: 98x+81x²-3267y-8019y²-6561y³-414
[49+243x,33+243y]:  unknown -> [138] [0,0] 98x+243x²-3267y-24057y²-59049y³-138
[49+243x,114+243y]: unknown -> [139] [0,1] 98x+243x²-38988y-83106y²-59049y³-6087
[49+243x,195+243y]: unknown -> [140] [0,2] 98x+243x²-114075y-142155y²-59049y³-30504
endexp[46]
expanding queue[47]^15,meter=[3,3]: 98x+81x²-10800y-14580y²-6561y³-2637
[49+243x,60+243y]:  unknown -> [141] [0,0] 98x+243x²-10800y-43740y²-59049y³-879
[49+243x,141+243y]: unknown -> [142] [0,1] 98x+243x²-59643y-102789y²-59049y³-11526
[49+243x,222+243y]: unknown -> [143] [0,2] 98x+243x²-147852y-161838y²-59049y³-45015
endexp[47]
expanding queue[48]^16,meter=[3,3]: 98x+81x²-675y-3645y²-6561y³-12
[49+243x,15+243y]:  unknown -> [144] [0,0] 98x+243x²-675y-10935y²-59049y³-4
[49+243x,96+243y]:  unknown -> [145] [0,1] 98x+243x²-27648y-69984y²-59049y³-3631
[49+243x,177+243y]: unknown -> [146] [0,2] 98x+243x²-93987y-129033y²-59049y³-22810
endexp[48]
expanding queue[49]^16,meter=[3,3]: 98x+81x²-5292y-10206y²-6561y³-885
[49+243x,42+243y]:  unknown -> [147] [0,0] 98x+243x²-5292y-30618y²-59049y³-295
[49+243x,123+243y]: unknown -> [148] [0,1] 98x+243x²-45387y-89667y²-59049y³-7648
[49+243x,204+243y]: unknown -> [149] [0,2] 98x+243x²-124848y-148716y²-59049y³-34927
endexp[49]
expanding queue[50]^16,meter=[3,3]: 98x+81x²-14283y-16767y²-6561y³-4026
[49+243x,69+243y]:  unknown -> [150] [0,0] 98x+243x²-14283y-50301y²-59049y³-1342
[49+243x,150+243y]: unknown -> [151] [0,1] 98x+243x²-67500y-109350y²-59049y³-13879
[49+243x,231+243y]: unknown -> [152] [0,2] 98x+243x²-160083y-168399y²-59049y³-50716
endexp[50]
expanding queue[51]^17,meter=[3,3]: 98x+81x²-1728y-5832y²-6561y³-141
[49+243x,24+243y]:  unknown -> [153] [0,0] 98x+243x²-1728y-17496y²-59049y³-47
[49+243x,105+243y]: unknown -> [154] [0,1] 98x+243x²-33075y-76545y²-59049y³-4754
[49+243x,186+243y]: unknown -> [155] [0,2] 98x+243x²-103788y-135594y²-59049y³-26471
endexp[51]
expanding queue[52]^17,meter=[3,3]: 98x+81x²-7803y-12393y²-6561y³-1608
[49+243x,51+243y]:  unknown -> [156] [0,0] 98x+243x²-7803y-37179y²-59049y³-536
[49+243x,132+243y]: unknown -> [157] [0,1] 98x+243x²-52272y-96228y²-59049y³-9455
[49+243x,213+243y]: unknown -> [158] [0,2] 98x+243x²-136107y-155277y²-59049y³-39758
endexp[52]
expanding queue[53]^17,meter=[3,3]: 98x+81x²-18252y-18954y²-6561y³-5829
[49+243x,78+243y]:  unknown -> [159] [0,0] 98x+243x²-18252y-56862y²-59049y³-1943
[49+243x,159+243y]: unknown -> [160] [0,1] 98x+243x²-75843y-115911y²-59049y³-16532
[49+243x,240+243y]: unknown -> [161] [0,2] 98x+243x²-172800y-174960y²-59049y³-56879
endexp[53]
expanding queue[54]^18,meter=[3,3]: 118x+81x²-6561y³+43
[221+243x,0+243y]:  unknown -> [162] [2,0] 442x+243x²-59049y³+201
[221+243x,81+243y]: unknown -> [163] [2,1] 442x+243x²-19683y-59049y²-59049y³-1986
[221+243x,162+243y]:    unknown -> [164] [2,2] 442x+243x²-78732y-118098y²-59049y³-17295
endexp[54]
expanding queue[55]^18,meter=[3,3]: 118x+81x²-2187y-6561y²-6561y³-200
[221+243x,27+243y]: unknown -> [165] [2,0] 442x+243x²-2187y-19683y²-59049y³+120
[221+243x,108+243y]:    unknown -> [166] [2,1] 442x+243x²-34992y-78732y²-59049y³-4983
[221+243x,189+243y]:    unknown -> [167] [2,2] 442x+243x²-107163y-137781y²-59049y³-27582
endexp[55]
expanding queue[56]^18,meter=[3,3]: 118x+81x²-8748y-13122y²-6561y³-1901
[221+243x,54+243y]: unknown -> [168] [2,0] 442x+243x²-8748y-39366y²-59049y³-447
[221+243x,135+243y]:    unknown -> [169] [2,1] 442x+243x²-54675y-98415y²-59049y³-9924
[221+243x,216+243y]:    unknown -> [170] [2,2] 442x+243x²-139968y-157464y²-59049y³-41271
endexp[56]
expanding queue[57]^19,meter=[3,3]: 118x+81x²-243y-2187y²-6561y³+34
[221+243x,9+243y]:  unknown -> [171] [2,0] 442x+243x²-243y-6561y²-59049y³+198
[221+243x,90+243y]: unknown -> [172] [2,1] 442x+243x²-24300y-65610y²-59049y³-2799
[221+243x,171+243y]:    unknown -> [173] [2,2] 442x+243x²-87723y-124659y²-59049y³-20376
endexp[57]
expanding queue[58]^19,meter=[3,3]: 118x+81x²-3888y-8748y²-6561y³-533
[221+243x,36+243y]: unknown -> [174] [2,0] 442x+243x²-3888y-26244y²-59049y³+9
[221+243x,117+243y]:    unknown -> [175] [2,1] 442x+243x²-41067y-85293y²-59049y³-6390
[221+243x,198+243y]:    unknown -> [176] [2,2] 442x+243x²-117612y-144342y²-59049y³-31743
endexp[58]
expanding queue[59]^19,meter=[3,3]: 118x+81x²-11907y-15309y²-6561y³-3044
[221+243x,63+243y]: unknown -> [177] [2,0] 442x+243x²-11907y-45927y²-59049y³-828
[221+243x,144+243y]:    unknown -> [178] [2,1] 442x+243x²-62208y-104976y²-59049y³-12087
[221+243x,225+243y]:    unknown -> [179] [2,2] 442x+243x²-151875y-164025y²-59049y³-46674
endexp[59]
expanding queue[60]^20,meter=[3,3]: 118x+81x²-972y-4374y²-6561y³-29
[221+243x,18+243y]: unknown -> [180] [2,0] 442x+243x²-972y-13122y²-59049y³+177
[221+243x,99+243y]: unknown -> [181] [2,1] 442x+243x²-29403y-72171y²-59049y³-3792
[221+243x,180+243y]:    unknown -> [182] [2,2] 442x+243x²-97200y-131220y²-59049y³-23799
endexp[60]
expanding queue[61]^20,meter=[3,3]: 118x+81x²-6075y-10935y²-6561y³-1082
[221+243x,45+243y]: unknown -> [183] [2,0] 442x+243x²-6075y-32805y²-59049y³-174
[221+243x,126+243y]:    unknown -> [184] [2,1] 442x+243x²-47628y-91854y²-59049y³-8031
[221+243x,207+243y]:    unknown -> [185] [2,2] 442x+243x²-128547y-150903y²-59049y³-36300
endexp[61]
expanding queue[62]^20,meter=[3,3]: 118x+81x²-15552y-17496y²-6561y³-4565
[221+243x,72+243y]: unknown -> [186] [2,0] 442x+243x²-15552y-52488y²-59049y³-1335
[221+243x,153+243y]:    unknown -> [187] [2,1] 442x+243x²-70227y-111537y²-59049y³-14538
[221+243x,234+243y]:    unknown -> [188] [2,2] 442x+243x²-164268y-170586y²-59049y³-52527
endexp[62]
expanding queue[63]^21,meter=[3,3]: 10x+81x²-27y-729y²-6561y³
[5+243x,3+243y]:    unknown -> [189] [0,0] 10x+243x²-27y-2187y²-59049y³
-> solution [5,3],NONTRIVIAL
[5+243x,84+243y]:   unknown -> [190] [0,1] 10x+243x²-21168y-61236y²-59049y³-2439
[5+243x,165+243y]:  unknown -> [191] [0,2] 10x+243x²-81675y-120285y²-59049y³-18486
endexp[63]
expanding queue[64]^21,meter=[3,3]: 10x+81x²-2700y-7290y²-6561y³-333
[5+243x,30+243y]:   unknown -> [192] [0,0] 10x+243x²-2700y-21870y²-59049y³-111
[5+243x,111+243y]:  unknown -> [193] [0,1] 10x+243x²-36963y-80919y²-59049y³-5628
[5+243x,192+243y]:  unknown -> [194] [0,2] 10x+243x²-110592y-139968y²-59049y³-29127
endexp[64]
expanding queue[65]^21,meter=[3,3]: 10x+81x²-9747y-13851y²-6561y³-2286
[5+243x,57+243y]:   unknown -> [195] [0,0] 10x+243x²-9747y-41553y²-59049y³-762
[5+243x,138+243y]:  unknown -> [196] [0,1] 10x+243x²-57132y-100602y²-59049y³-10815
[5+243x,219+243y]:  unknown -> [197] [0,2] 10x+243x²-143883y-159651y²-59049y³-43224
endexp[65]
expanding queue[66]^22,meter=[3,3]: 10x+81x²-432y-2916y²-6561y³-21
[5+243x,12+243y]:   unknown -> [198] [0,0] 10x+243x²-432y-8748y²-59049y³-7
[5+243x,93+243y]:   unknown -> [199] [0,1] 10x+243x²-25947y-67797y²-59049y³-3310
[5+243x,174+243y]:  unknown -> [200] [0,2] 10x+243x²-90828y-126846y²-59049y³-21679
endexp[66]
expanding queue[67]^22,meter=[3,3]: 10x+81x²-4563y-9477y²-6561y³-732
[5+243x,39+243y]:   unknown -> [201] [0,0] 10x+243x²-4563y-28431y²-59049y³-244
[5+243x,120+243y]:  unknown -> [202] [0,1] 10x+243x²-43200y-87480y²-59049y³-7111
[5+243x,201+243y]:  unknown -> [203] [0,2] 10x+243x²-121203y-146529y²-59049y³-33418
endexp[67]
expanding queue[68]^22,meter=[3,3]: 10x+81x²-13068y-16038y²-6561y³-3549
[5+243x,66+243y]:   unknown -> [204] [0,0] 10x+243x²-13068y-48114y²-59049y³-1183
[5+243x,147+243y]:  unknown -> [205] [0,1] 10x+243x²-64827y-107163y²-59049y³-13072
[5+243x,228+243y]:  unknown -> [206] [0,2] 10x+243x²-155952y-166212y²-59049y³-48775
endexp[68]
expanding queue[69]^23,meter=[3,3]: 10x+81x²-1323y-5103y²-6561y³-114
[5+243x,21+243y]:   unknown -> [207] [0,0] 10x+243x²-1323y-15309y²-59049y³-38
[5+243x,102+243y]:  unknown -> [208] [0,1] 10x+243x²-31212y-74358y²-59049y³-4367
[5+243x,183+243y]:  unknown -> [209] [0,2] 10x+243x²-100467y-133407y²-59049y³-25220
endexp[69]
expanding queue[70]^23,meter=[3,3]: 10x+81x²-6912y-11664y²-6561y³-1365
[5+243x,48+243y]:   unknown -> [210] [0,0] 10x+243x²-6912y-34992y²-59049y³-455
[5+243x,129+243y]:  unknown -> [211] [0,1] 10x+243x²-49923y-94041y²-59049y³-8834
[5+243x,210+243y]:  unknown -> [212] [0,2] 10x+243x²-132300y-153090y²-59049y³-38111
endexp[70]
expanding queue[71]^23,meter=[3,3]: 10x+81x²-16875y-18225y²-6561y³-5208
[5+243x,75+243y]:   unknown -> [213] [0,0] 10x+243x²-16875y-54675y²-59049y³-1736
[5+243x,156+243y]:  unknown -> [214] [0,1] 10x+243x²-73008y-113724y²-59049y³-15623
[5+243x,237+243y]:  unknown -> [215] [0,2] 10x+243x²-168507y-172773y²-59049y³-54782
endexp[71]
expanding queue[72]^24,meter=[3,3]: 64x+81x²-108y-1458y²-6561y³+10
[194+243x,6+243y]:  unknown -> [216] [2,0] 388x+243x²-108y-4374y²-59049y³+154
[194+243x,87+243y]: unknown -> [217] [2,1] 388x+243x²-22707y-63423y²-59049y³-2555
[194+243x,168+243y]:    unknown -> [218] [2,2] 388x+243x²-84672y-122472y²-59049y³-19358
endexp[72]
expanding queue[73]^24,meter=[3,3]: 64x+81x²-3267y-8019y²-6561y³-431
[194+243x,33+243y]: unknown -> [219] [2,0] 388x+243x²-3267y-24057y²-59049y³+7
[194+243x,114+243y]:    unknown -> [220] [2,1] 388x+243x²-38988y-83106y²-59049y³-5942
[194+243x,195+243y]:    unknown -> [221] [2,2] 388x+243x²-114075y-142155y²-59049y³-30359
endexp[73]
expanding queue[74]^24,meter=[3,3]: 64x+81x²-10800y-14580y²-6561y³-2654
[194+243x,60+243y]: unknown -> [222] [2,0] 388x+243x²-10800y-43740y²-59049y³-734
[194+243x,141+243y]:    unknown -> [223] [2,1] 388x+243x²-59643y-102789y²-59049y³-11381
[194+243x,222+243y]:    unknown -> [224] [2,2] 388x+243x²-147852y-161838y²-59049y³-44870
endexp[74]
expanding queue[75]^25,meter=[3,3]: 64x+81x²-675y-3645y²-6561y³-29
[194+243x,15+243y]: unknown -> [225] [2,0] 388x+243x²-675y-10935y²-59049y³+141
[194+243x,96+243y]: unknown -> [226] [2,1] 388x+243x²-27648y-69984y²-59049y³-3486
[194+243x,177+243y]:    unknown -> [227] [2,2] 388x+243x²-93987y-129033y²-59049y³-22665
endexp[75]
expanding queue[76]^25,meter=[3,3]: 64x+81x²-5292y-10206y²-6561y³-902
[194+243x,42+243y]: unknown -> [228] [2,0] 388x+243x²-5292y-30618y²-59049y³-150
[194+243x,123+243y]:    unknown -> [229] [2,1] 388x+243x²-45387y-89667y²-59049y³-7503
[194+243x,204+243y]:    unknown -> [230] [2,2] 388x+243x²-124848y-148716y²-59049y³-34782
endexp[76]
expanding queue[77]^25,meter=[3,3]: 64x+81x²-14283y-16767y²-6561y³-4043
[194+243x,69+243y]: unknown -> [231] [2,0] 388x+243x²-14283y-50301y²-59049y³-1197
[194+243x,150+243y]:    unknown -> [232] [2,1] 388x+243x²-67500y-109350y²-59049y³-13734
[194+243x,231+243y]:    unknown -> [233] [2,2] 388x+243x²-160083y-168399y²-59049y³-50571
endexp[77]
expanding queue[78]^26,meter=[3,3]: 64x+81x²-1728y-5832y²-6561y³-158
[194+243x,24+243y]: unknown -> [234] [2,0] 388x+243x²-1728y-17496y²-59049y³+98
[194+243x,105+243y]:    unknown -> [235] [2,1] 388x+243x²-33075y-76545y²-59049y³-4609
[194+243x,186+243y]:    unknown -> [236] [2,2] 388x+243x²-103788y-135594y²-59049y³-26326
endexp[78]
expanding queue[79]^26,meter=[3,3]: 64x+81x²-7803y-12393y²-6561y³-1625
[194+243x,51+243y]: unknown -> [237] [2,0] 388x+243x²-7803y-37179y²-59049y³-391
[194+243x,132+243y]:    unknown -> [238] [2,1] 388x+243x²-52272y-96228y²-59049y³-9310
[194+243x,213+243y]:    unknown -> [239] [2,2] 388x+243x²-136107y-155277y²-59049y³-39613
endexp[79]
expanding queue[80]^26,meter=[3,3]: 64x+81x²-18252y-18954y²-6561y³-5846
[194+243x,78+243y]: unknown -> [240] [2,0] 388x+243x²-18252y-56862y²-59049y³-1798
[194+243x,159+243y]:    unknown -> [241] [2,1] 388x+243x²-75843y-115911y²-59049y³-16387
[194+243x,240+243y]:    unknown -> [242] [2,2] 388x+243x²-172800y-174960y²-59049y³-56734
endexp[80]
---------------- level 5
Maximum level 5 [243] mod 3: x²-y³+2
